#!/bin/bash
set -e

# If RAILS_MASTER_KEY is set, create the master.key file
if [ -n "$RAILS_MASTER_KEY" ]; then
  echo "Setting up Rails credentials from RAILS_MASTER_KEY environment variable..."
  mkdir -p config
  echo "$RAILS_MASTER_KEY" > config/master.key
  chmod 600 config/master.key
  echo "✓ config/master.key created successfully"
else
  echo "⚠️  Warning: RAILS_MASTER_KEY environment variable not set!"
fi

# Run the actual puma command
exec "$@"
