// active-x-obfuscator@0.0.1 downloaded from https://ga.jspm.io/npm:active-x-obfuscator@0.0.1/index.js

import e from"zeparser";import t from"util";var r="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var c={};var i=e.ZeParser;var a=t;c=ActiveXObfuscator;function ActiveXObfuscator(e){if(!((this||r)instanceof ActiveXObfuscator)){var t=new ActiveXObfuscator(e);t.execute();return t.toString()}(this||r)._parser=i.createParser(e)}var o=ActiveXObfuscator.OBFUSCATED_ACTIVE_X_OBJECT="(['Active'].concat('Object').join('X'))";var s=ActiveXObfuscator.OBFUSCATED_ACTIVE_X="(['Active'].concat('').join('X'))";ActiveXObfuscator.prototype.execute=function(){(this||r)._parser.tokenizer.fixValues();this._obfuscate(this.getAst())};ActiveXObfuscator.prototype.getAst=function(){return(this||r)._parser.stack};ActiveXObfuscator.prototype.getWhiteTokens=function(){return(this||r)._parser.tokenizer.wtree};ActiveXObfuscator.prototype._obfuscate=function(e){var t=this||r;e.forEach((function(r,c){if(Array.isArray(r))t._obfuscate(r);else switch(r.value){case"ActiveXObject":if(!r.isPropertyName){r.value="window["+o+"]";break}var i=e[c-1];var n=t.getWhiteTokens();n[i.tokposw].value="";r.value="["+o+"]";break;case"'ActiveXObject'":case'"ActiveXObject"':r.value=o;break;case"'ActiveX'":case'"ActiveX"':r.value=s;break;default:if(!/ActiveX/i.test(r.value))break;if(!r.isComment)throw new Error("Unknown ActiveX occurence in: "+a.inspect(r));r.value=r.value.replace(/ActiveX/i,"Ac...eX")}}))};ActiveXObfuscator.prototype.toString=function(){var e=this.getWhiteTokens();return e.reduce((function(e,t){return e+=t.value}),"")};var n=c;export default n;

