<% show_expired ||= false %>
<div class="bg-white rounded-lg shadow <%= 'opacity-60' if show_expired %> <%= 'border-l-4' if announcement.pinned || announcement.priority == 'urgent' || announcement.priority == 'high' %> <%= 'border-red-500' if announcement.priority == 'urgent' %> <%= 'border-orange-500' if announcement.priority == 'high' %> <%= 'border-blue-500' if announcement.pinned && announcement.priority == 'normal' %>">
  <div class="p-6">
    <!-- Header -->
    <div class="flex items-start justify-between mb-4">
      <div class="flex-1">
        <div class="flex items-center space-x-2 mb-2">
          <!-- Priority Badge -->
          <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-<%= announcement.priority_badge_color %>-100 text-<%= announcement.priority_badge_color %>-800">
            <%= announcement.priority_icon %> <%= announcement.priority.titleize %>
          </span>
          
          <!-- Pinned Badge -->
          <% if announcement.pinned %>
            <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800">
              üìå Pinned
            </span>
          <% end %>
          
          <!-- Status Badges -->
          <% if announcement.draft? %>
            <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800">
              üìù Draft
            </span>
          <% end %>
          
          <% if show_expired %>
            <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800">
              üïê Expired
            </span>
          <% end %>
        </div>
        
        <h3 class="text-lg font-semibold text-gray-900">
          <%= link_to announcement.title, announcement_path(announcement), class: 'hover:text-blue-600' %>
        </h3>
        
        <p class="text-sm text-gray-500 mt-1">
          by <%= announcement.user.name %> ‚Ä¢ 
          <%= announcement.published? ? time_ago_in_words(announcement.published_at) + ' ago' : 'Not published' %>
          <% if announcement.expires_at %>
            ‚Ä¢ Expires <%= time_ago_in_words(announcement.expires_at) %> <%= announcement.expired? ? 'ago' : 'from now' %>
          <% end %>
        </p>
      </div>
      
      <!-- Actions -->
      <% if can_manage_announcements? %>
        <div class="flex items-center space-x-2 ml-4">
          <%= link_to 'üìù', edit_announcement_path(announcement), class: 'text-gray-600 hover:text-blue-600', title: 'Edit' %>
          <%= link_to 'üóëÔ∏è', announcement_path(announcement), method: :delete, data: { confirm: 'Are you sure?' }, class: 'text-gray-600 hover:text-red-600', title: 'Delete' %>
        </div>
      <% end %>
    </div>
    
    <!-- Content Preview -->
    <div class="text-gray-700 mb-4">
      <% content_preview = truncate(announcement.content, length: 200) %>
      <%= simple_format(content_preview) %>
      <% if announcement.content.length > 200 %>
        <%= link_to 'Read more ‚Üí', announcement_path(announcement), class: 'text-blue-600 hover:text-blue-800' %>
      <% end %>
    </div>
    
    <!-- Action Buttons -->
    <% if can_manage_announcements? %>
      <div class="flex items-center space-x-3 pt-4 border-t border-gray-200">
        <% if announcement.draft? %>
          <%= button_to 'Publish', publish_announcement_path(announcement), method: :patch, class: 'inline-flex items-center px-3 py-1 border border-transparent rounded text-sm font-medium text-white bg-green-600 hover:bg-green-700' %>
        <% elsif announcement.published? %>
          <%= button_to 'Unpublish', unpublish_announcement_path(announcement), method: :patch, class: 'inline-flex items-center px-3 py-1 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50' %>
        <% end %>
        
        <% if announcement.published? %>
          <%= button_to announcement.pinned? ? 'Unpin' : 'Pin', toggle_pin_announcement_path(announcement), method: :patch, class: 'inline-flex items-center px-3 py-1 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50' %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
